#!/bin/bash
# ------------------------------------------------------------------
#
#     Scripts/batperc
#     Description: Script for piping the battery status into dzen
#     Author: Alex SÃ¡nchez <kniren@gmail.com>
#
# ------------------------------------------------------------------

BAT=`acpi -b | awk '{gsub(/%,/,""); print $4}'`
STATUS=`acpi -b | awk '{gsub(/,/,""); print $3}'`

if [[ $BAT -lt 10  ]]; then
    ICON="bat_empty_02.xbm"
    BATBAR=`echo -e "$BAT"\
        | gdbar -bg darkgrey -fg red -h 5 -w 50`
    if [[ $STATUS != "Charging" ]]; then
        notify-send "Warning, battery level below 10 percent" -u critical -t 30000
    fi
else
    ICON="bat_full_02.xbm"
    BATBAR=`echo -e "$BAT"\
        | gdbar -bg darkgrey -fg white -h 5 -w 50`
fi

if [[ $STATUS != "Discharging" ]]; then
    ICON="ac.xbm"
fi
ICON='^i(/home/alex/.xmonad/dzen/icons/xbm8x8/'"$ICON)"
echo "$ICON $BATBAR"
