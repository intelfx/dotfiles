#!/bin/zsh

#
# Status output if running on terminal
#

function rsync() {
	if [[ -t 2 && -t 1 ]]; then
		command rsync --info=progress2 --human-readable "$@"
	else
		command rsync "$@"
	fi
}

function tar() {
	if [[ -t 2 && -t 1 ]]; then
		command tar --checkpoint=1000 --checkpoint-action=ttyout=%c "$@"
	else
		command tar "$@"
	fi
}

function diff() {
	if [[ -t 2 && -t 1 ]]; then
		command colordiff "$@"
	else
		command diff "$@"
	fi
}

function dd() {
	if [[ -t 2 && -t 1 ]]; then
		command dd status=progress "$@"
	else
		command dd "$@"
	fi
}

function pv() {
	if [[ -t 2 && -t 1 ]]; then
		command pv -ctebar "$@"
	else
		command pv "$@"
	fi
}

#-------------------
# Personnal Aliases
#-------------------

alias mkdir='mkdir -pv'

alias ..='cd ..'
alias cd..='cd ..'

alias du='du -h'    # Makes a more readable output.
alias df='df -Th'

# Pretty-print of some PATH variables:
alias path='echo -e ${PATH//:/\\n}'
alias libpath='echo -e ${LD_LIBRARY_PATH//:/\\n}'

alias catconfig='grep -vE "^$|^ *(#|;)"'
alias fields='cut -d " " -f '

alias wget='wget -c'
alias bc='bc -l'
alias sha1='openssl sha1'
alias diff='colordiff'

alias r-cp-n='rsync -r --partial --no-i-r'
alias r-cp='r-cp-n -aHAX'
alias r-mv='r-cp --remove-source-files'
alias r-sync='r-cp --delete'

function cmake() {
	command cmake -G Ninja "$@"
}

function cmake-c() {
	cmake -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ "$@"
}

function ccmake() {
	command ccmake -G Ninja "$@"
}

function ccmake-c() {
	ccmake -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ "$@"
}

function mkcd() {
	mkdir -pv "$1" && cd "$1"
}

function make() {
	if ! [[ -e GNUmakefile || -e Makefile || -e makefile ]]; then
		command make -f ~/bin/Makefile "$@" # any -f given later in the command line will override this one
	else
		command make "$@"
	fi
}

function setfacl-d() {
	setfacl -d "$@" && setfacl "$@"
}
